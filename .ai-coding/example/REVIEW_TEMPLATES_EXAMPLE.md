# 评审标准（Agent 自检用）

Agent 在每个阶段结束时自动按此标准评审，输出评审结论。用户无需参与，除非主动要求交互式评审。

---

## 使用方式

- **默认模式**：Agent 自动评审，输出进度和效率指标
- **交互模式**：用户说"详细评审"或"逐项检查"时，逐条展示

---

## 阶段标识

### 完整进度条（阶段切换时显示）

```
[🔍 澄清] → [📐 设计] → [⚡ 执行] → [✅ 校验] → [📝 总结]
              ▲ 当前
```

### 阶段说明

| 图标 | 阶段 | 含义 | 允许行为 |
|---|---|---|---|
| 🔍 | 澄清 | 理解需求 | 询问、拆解、不做假设 |
| 📐 | 设计 | 方案规划 | 结构化推理、给选项 |
| ⚡ | 执行 | 编码/写文档 | 直接 action，禁止复述 |
| ✅ | 校验 | 检查结果 | 对照检查、指出风险 |
| 📝 | 总结 | 沉淀产出 | 结构化总结 |

### 阶段切换

切换阶段时明确告知用户，例如：

```
进入 ⚡执行 阶段

[🔍 澄清] → [📐 设计] → [⚡ 执行] → [✅ 校验] → [📝 总结]
                          ▲ 当前
```

---

## 对话评审（Agent 自检）

Agent 每次输出前自检：

1. **阶段正确** - 当前处于哪个阶段？是否跨阶段？
2. **收敛输出** - 是否给出有限选项而非无边界发散？
3. **避免冗余** - 是否重复了用户已确认的内容？
4. **阻塞处理** - 缺少信息时是否中断而非假设？

自检通过 → 直接输出
自检失败 → 调整后输出，或说明阻塞原因

---

## 变更评审（提交前自检）

Agent 提交代码/PR 前自检：

必检项
- [ ] 只做了声明范围内的改动
- [ ] 无意外的行为变化
- [ ] 已运行 lint
- [ ] 已说明验证方式

扩展项（如涉及）
- [ ] 公共组件/配置变更已说明影响
- [ ] 新依赖已说明必要性
- [ ] 有回滚建议（如需）

---

## 输出格式

### 简化版（每次输出末尾）

```
进度：📐设计 → ⚡执行 | 轮次 5 | +32 -10 行
```

### 效率指标（阶段结束或任务完成时）

```
📊 本次对话统计
轮次：12 | Tokens：~8.2k | 变更：+156 -23 ~45
🤖 15min | 🧑‍💻 3h | ⬇️ 2.75h
```

- 🤖 = AI 实际耗时
- 🧑‍💻 = 人力预估耗时
- ⬇️ = 节约时间

### 需确认时

```
⚠️ 需确认 | 📐设计 | 变更超出声明范围，是否继续？
```

### 阻塞时

```
❌ 阻塞 | 🔍澄清 | 缺少必要信息，请补充 XXX
```

---

## 交互式评审（仅按需）

用户说以下关键词时进入交互模式：
- "详细评审"
- "逐项检查"
- "展开评审"

交互模式下逐条展示检查项和结果。

---

## Emoji 使用规则

| 场景 | 规则 |
|---|---|
| 对话 | ✅ 大量使用，替代文字 |
| PROJECT_STATE.md | ✅ 大量使用 |
| 文档（AGENTS.md 等） | ✅ 大量使用 |
| code comment | ⚠️ 谨慎使用 |
| commit message | ❌ 绝不使用 |
